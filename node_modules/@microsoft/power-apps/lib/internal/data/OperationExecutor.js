/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
import { executePluginAsync } from '../plugin/PluginCommon';
import { loadConnections } from './ConnectionUtils';
let loadConnectionsPromise;
/**
 * Executes operations using the plugin.
 */
export class OperationExecutor {
    /**
     * Executes an operation using the plugin.
     * @param operationName The name of the operation.
     * @param action The action to perform.
     * @param params The parameters for the operation.
     * @returns A promise resolving to the operation result.
     */
    async execute(operationName, action, params) {
        try {
            if (!loadConnectionsPromise) {
                loadConnectionsPromise = loadConnections();
            }
            await loadConnectionsPromise;
            const result = await executePluginAsync(operationName, action, params);
            return {
                success: true,
                data: result,
            };
        }
        catch (error) {
            throw error;
        }
    }
}
//# sourceMappingURL=OperationExecutor.js.map